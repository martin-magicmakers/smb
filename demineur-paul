#Paul, tu ne m'as partagÃ© ton projet hier !
#Pour avoir les derniers changements, connecte-toi directement sur ton compte colab perso (et partage-le-moi Ã  martin.birraux@magicmakers.fr ! il Ã©tait vraiment cool !)

import random

taille_grille = 10
nb_bombes = 10

# GÃ©nÃ©ration de toutes les coordonnÃ©es possibles de la grille

liste_cases = []
liste_lignes = range(taille_grille)
liste_colonnes = range(taille_grille)
liste_emojis = ["0ï¸âƒ£â€‹","1ï¸âƒ£â€‹","2ï¸âƒ£â€‹","3ï¸âƒ£","4ï¸âƒ£","5ï¸âƒ£","6ï¸âƒ£","7ï¸âƒ£","8ï¸âƒ£","9ï¸âƒ£","â€‹ğŸ”Ÿâ€‹"]

for ligne in liste_lignes:
  for colonne in liste_colonnes:
    liste_cases.append((ligne, colonne))

liste_bombes = random.sample(liste_cases, nb_bombes)

cases_decouvertes = []

cases_marquees = []


def compter_bombes_autour(ligne, colonne):

  compteur_bombes = 0

  for decalage_ligne in [-1, 0, 1]:
    for decalage_colonne in [-1, 0, 1]:
      case_voisine = (ligne + decalage_ligne, colonne + decalage_colonne)
      if case_voisine in liste_bombes:
        compteur_bombes += 1

  return compteur_bombes


def afficher_grille():

    print("ğŸŸ« " + " ".join(liste_emojis[i] for i in range(1, taille_grille+1)))
    print("   " + "___" * taille_grille)

    for ligne in range(taille_grille):
        texte_ligne = liste_emojis[ligne]+"Ç€"
        for colonne in range(taille_grille):
          point = (ligne, colonne)

          if point in cases_decouvertes:
              if point in liste_bombes:
                  texte_ligne += "ğŸ’£"
              else:
                  nb = compter_bombes_autour(ligne, colonne)
                  texte_ligne += liste_emojis[nb]

          # Case non dÃ©couverte mais marquÃ©e par un drapeau
          elif point in cases_marquees:
              texte_ligne += "ğŸ†˜â€‹"

          # Case encore cachÃ©e
          else:
              texte_ligne += "â¹ï¸â€‹"

          texte_ligne += " "

        print(texte_ligne)


def jouer():

    print("ğŸ’£ Bienvenue dans le DÃ‰MINEUR  ")
    print(f"Il y a {nb_bombes} bombes cachÃ©es. Ã€ toi de jouer !\n")
    print("   Tape 'd' pour dÃ©couvrir une case, 'f' pour poser/retirer un drapeau.\n")

    while True:

        afficher_grille()

        # Condition de victoire : toutes les cases non-bombes sont dÃ©couvertes
        if len(cases_decouvertes) == taille_grille * taille_grille - nb_bombes :
            print("ğŸ‰ Bravo ! Tu as dÃ©couvert toutes les cases sans exploser !")
            afficher_grille()
            break

        action = input("Action (d = dÃ©couvrir, f = drapeau) : ").strip().lower()
        if action not in ("d", "f"):
            print("â›” Action invalide. Tape 'd' ou 'f'.")
            continue

        try:
            ligne = int(input("Choisis une ligne : "))
            colonne = int(input("Choisis une colonne : "))

        except ValueError:
            print("â›” Entrez des nombres valides.")
            continue

        point = (ligne-1, colonne-1)
        if not (1 <= ligne < taille_grille+1 and 1 <= colonne < taille_grille+1):
            print("â›” CoordonnÃ©es hors de la grille.")
            continue

        if action == "f":
            if point in cases_decouvertes:
                print("âš ï¸ Tu ne peux pas mettre de drapeau sur une case dÃ©jÃ  dÃ©couverte.")
                continue

            cases_marquees.append(point)
            print("âœ… Drapeau posÃ©.")
            continue  # On passe au tour suivant sans rÃ©vÃ©ler de case

        # ----- DÃ‰COUVERTE D'UNE CASE -----
        if action == "d":
            # On Ã©vite de dÃ©couvrir une case marquÃ©e par un drapeau
            if point in cases_marquees:
                print("âš ï¸ Cette case est marquÃ©e par un drapeau. Retire-le d'abord si tu veux la dÃ©couvrir.")
                continue

            if point in cases_decouvertes:
                print("âš ï¸ Tu as dÃ©jÃ  dÃ©couvert cette case.")
                continue

            # On rÃ©vÃ¨le la case
            cases_decouvertes.append(point)

            # Si c'est une bombe â†’ dÃ©faite
            if point in liste_bombes:
                print("ğŸ’¥ BOUM ! Tu es tombÃ© sur une bombe !")
                afficher_grille()
                print("ğŸ’€ Partie terminÃ©e.")
                break


jouer()


